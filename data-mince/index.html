<!DOCTYPE html>
<html>
  <head>
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../css/reset.css">
    <link rel="stylesheet" type="text/css" href="../css/header.css">
    <link rel="stylesheet" type="text/css" href="../css/jarg.css">
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' />
    <link rel="shortcut icon" href="../assets/Jargonautical_web_icon.jpg" />
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Caveat&family=Grape+Nuts&family=Nunito&family=Rock+Salt&display=swap');
    </style>
    <div class='hero-image'></div>
	  <!-- Load plotly.js into the DOM -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>         
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
  </head>
  <body>
    
    <div id="intro">
    <h1>Using open data to understand a place</h1>
    <p>
    Something I have found when I work on projects for different clients, no
    matter how sophisticated the toolset or how complex the problem, I
    almost always need to start with the same initial collection of demographic
    data; population, income, deprivation, working patterns and so on. This is
    your starter kit for understanding some of the patterns in the location you're 
    trying to analyse;<br><br>
    - population,<br>
    - deprivation<br>
    - economic activity.<br>
    <br>
    All of the data I use here is UK government open data, published under the 
    <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/">Open Government Licence</a> as open data.
  </p>
  </div>
  <h2>Population variations by age</h2>

  <div id="pop-section" class="flex-container">

    <div class="invisbox">
      <p>I always find it useful to look at the distribution of ages
        rather than the absolute values; the shape of a place's age
        profile tells you a lot when you compare it to the wider
        area. For example, Exeter and Plymouth stand out in this chart
        because of the much higher numbers of resident young people
        due to the universities. Torbay on the other hand has a profile skewed
        towards the older age ranges, as many people retire to the area.<br><br>
        Use the dropdown to select different Devon districts.<br>
        Source: <a href="https://www.nomisweb.co.uk/query/construct/summary.asp?mode=construct&version=0&dataset=2002">ONS population estimates.</a>
      </p>
    </div>

    <div class="invisbox">
      <p>
        If we were looking at something like vulnerability profiles, during COVID for 
        example, then both groups
        would be of interest. Viral outbreaks are particularly concerning
        for the elderly and anyone with an underlying health condition, but young people
        are by no means immune. In fact a university environment can carry extra risks,
        e.g. dorms, house shares, group tutorials and lectures in spaces that see a
        lot of use.
    </p>
    </div>

  </div>

  <div>
    <div id="pop">
      <div class="bubbleplot" data-num="1">
        <div class="control-row1">
          District: <select class="districtdata">
          </select>
        </div>
        <div class="plot" id="popDiv"></div>
      </div>
    </div>
  </div>

  <h2>Economic vulnerability and differential impacts</h2>


  <div id="emp-section" class="flex-container">

    <div class="invisbox">
      <p>
        Health isn't the only vulnerability factor; for many people self-employment,
        freelance and contracting work and zero-hours contracts have become a standard
        part of their income generation. To take a look at the potential numbers of
        people affected we can use the ONS Annual Labour Survey data - latest is for
        the year from October 2023 to September 2024<br><br>
        Source: <a href="https://www.nomisweb.co.uk/query/construct/summary.asp?mode=construct&version=0&dataset=141">ONS UK Business Counts</a>
      </p>
    </div>

    <div class="invisbox">
      <p>
        These charts show two different attributes of the UK Business Counts data;
        the breakdown by legal status, which shows us the proportion of sole traders
        in a district, and the size band by number of employees so we can see where
        there's a high proportion of businesses with, for example, fewer than 5 people
        working there.
      </p>
    </div>

  </div>

  <div id="biz-section" class="flex-container">

    <div class="invisbox">
      <div id="se">
        <div class="bubbleplot" data-num="2">
          <div class="control-row2">
            District: <select class="districtdata">
            </select>
          </div>
          <div class="plot" id="empDiv"></div>
        </div>
      </div>
    </div>

    <div class="invisbox">
      <div id="biz">
        <div class="bubbleplot" data-num="4">
          <div class="control-row2">
            District: <select class="districtdata">
            </select>
          </div>
          <div class="plot" id="bizDiv"></div>
        </div>
      </div>
    </div>

  </div>

  <h2>Other measures of vulnerability</h2>

  <div id="imd-section" class="flex-container">

    <div class="invisbox-wide">
      <h3>Indices of Multiple Deprivation (IMD)</h3>
      <p>
        Income and employment are far from the only measure of wellbeing - although they certainly make a
        difference. The government's Indices of Multiple Deprivation (IMD) are updated every few
        years and cover a wider range of measures including environment, barriers to
        opportunity, health and crime.<br><br>
        The top-level index of deprivation is calculated from a combination of the
        contributing indices, and assigns every small area (LSOA, or Lower-level
        Super Output Area) in England a score based on how deprived the model says
        that area is in comparison to all the others. With all the LSOAs ranked in order,
        each one is then assigned to a decile with a numeric score from 1 to 10.
        Any LSOA with a decile score of 1 is therefore in the top 10% most deprived
        nationally; and the higher the decile score, the less deprived.<br><br>
        This chart looks at which LSOAs fall into which deciles, and we can see
        that the more urban areas like Torbay and Plymouth have a far greater
        proportion of LSOAs with lower decile scores.<br><br>
        Source: 
        <br>
        <a href="https://www.gov.uk/government/statistics/english-indices-of-deprivation-2019">UK Government - MHCLG</a>
        <br>
        <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/835115/IoD2019_Statistical_Release.pdf">Further reading</a>
      </p>
    </div>
  </div>
  <h3>Hover over the map to see more details.</h3>    
  <div class='flex-container'>
    <div id='map' class="invisbox-wide" style='height: 500px;'></div>
    <div class='map-overlay' id='features' style='position: relative; top: 0;'></div>
            <script>
              // define access token
              mapboxgl.accessToken = 'pk.eyJ1IjoiamFyZ29uYXV0IiwiYSI6ImNrZWUybmR5ZjBicWMyc295NTR4N3I4OWIifQ.scaKTg7g6zt8i9_zk8NjWg';
              // create map
              var map = new mapboxgl.Map({
                container: 'map', // container id
                //style: 'mapbox://styles/jargonaut/ckiabooyrdbcq19oyiwwh8j34', /*original*/
                //style: 'mapbox://styles/jargonaut/cmacoc14300pi01s355v0arto', /*Devon*/
                style: 'mapbox://styles/jargonaut/cmae66ast00rv01s4h4wtgyst', /*Devon warm*/
                center: [-3.82, 50.75], //50.756674, -3.828226
                zoom: 8
              });
              // wait for map to load before adjusting it
              map.on('load', function() {
                //make a pointer cursor
                map.getCanvas().style.cursor = 'default';
                // set map bounds
                // define layer names
                var colors = ['#ffffff', '#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'];
                // change info window on hover
                map.on('mousemove', function(e) {
                  var states = map.queryRenderedFeatures(e.point, {layers: ['IMD2019']});
                  if (states.length > 0) {
                    document.getElementById('pd').innerHTML = '<p class="console">LSOA ' + states[0].properties.lsoa11nm + ' is in decile: ' + states[0].properties.IMDDec0 + '<p>';
                  } else {
                    document.getElementById('pd').innerHTML = '<p class="console">Hover over an area to see the IMD Decile</p><br>';
                  }
                });
              });
            </script>
          </div>
    <div class="invisbox-small" id='legend'>
      <table>
        <tr>
          <td style='width: 25%;'>Most deprived</td>
          <td style='background-color: #662506;'> </td>
          <td style='background-color: #993404;'> </td>
          <td style='background-color: #cc4c02;'> </td>
          <td style='background-color: #ec7014;'> </td>
          <td style='background-color: #fe9929;'> </td>
          <td style='background-color: #fec44f;'> </td>
          <td style='background-color: #fee391;'> </td>
          <td style='background-color: #fff7bc;'> </td>
          <td style='background-color: #ffffe5;'> </td>
          <td style='background-color: #ffffff;'> </td>
          <td style='width: 25%;'>Least deprived</td>
        </tr>
      </table>
      <br>
      <br>
    
    
    <div id='pd'>
      <p class="console">Hover over an area to see the IMD Decile</p>
    </div>
  </div>

  </div>
  <hr>

  <!-- FOOTER SECTION -->
<h5>(c) Jargonautical Ltd 2020. Theme and branding by Jargonautical & Shufflewing</h5>
</body>

  <!-- SCRIPTS ............................................................ -->
  <script src='data-mince-pop.js'></script>
  <script src='data-mince-emp.js'></script>
  <script src='data-mince-biz.js'></script>
  <script src='data-reshape.js'></script>
</html>
